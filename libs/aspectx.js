var e={d:(n,r)=>{for(var t in r)e.o(r,t)&&!e.o(n,t)&&Object.defineProperty(n,t,{enumerable:!0,get:r[t]})},o:(e,n)=>Object.prototype.hasOwnProperty.call(e,n)},n={};function r(e){throw new TypeError('"'+e+'" is read-only')}function t(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function a(e,n){for(var r=0;r<n.length;r++){var t=n[r];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}e.d(n,{w:()=>Fe,K:()=>me});var o={Int8:1,UInt8:1,Int16:2,UInt16:2,Int32:4,UInt32:4,BigInt64:8,BigUInt64:8,Float:4,Double:8};const i=function(){function e(n){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t(this,e),this.endianness=r?"LE":"BE",this.buffer=n,this.position=0}var n,r;return n=e,(r=[{key:"readNumericType",value:function(e){var n=o[e],r=this.buffer.slice(this.position,this.position+n)["read"+e+(n>1?this.endianness:"")](0);return this.position+=n,r}},{key:"readDouble",value:function(){return this.readNumericType("Double")}},{key:"readFloat",value:function(){return this.readNumericType("Float")}},{key:"readShort",value:function(){return this.readNumericType("Int16")}},{key:"readInt",value:function(){return this.readNumericType("Int32")}},{key:"javaBoolean",value:function(){return-1==this.readShort()}},{key:"sexType",value:function(){return-1==this.readShort()?"MALE":"FEMALE"}},{key:"close",value:function(){}}])&&a(n.prototype,r),e}(),l={UNLABELLED:1,WHOLE_BODY:2,LEFT_LEG:3,RIGHT_LEG:4,TORSO:5,LEFT_ARM:7,RIGHT_ARM:8,CHEST_WALL:9,LEFT_BREAST:10,RIGHT_BREAST:11,MJB_BUST:12,properties:{1:{name:"Unlabelled"},2:{name:"Whole body"},3:{name:"Left leg"},4:{name:"Right leg"},5:{name:"Torso"},7:{name:"Left arm"},8:{name:"Right arm"},9:{name:"Chest wall"},10:{name:"Left breast"},11:{name:"Right breast"},12:{name:"MJB bust"}},fromInt:function(e){return Object.entries(this).filter((function(e){return"properties"!==e[0]&&"function"!=typeof e[0]})).find((function(n){return n[1]===e}))[0]}};function _(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,t=new Array(n);r<n;r++)t[r]=e[r];return t}function s(e,n){var r,t=function(e,n){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,n){if(e){if("string"==typeof e)return _(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_(e,n):void 0}}(e))||n&&e&&"number"==typeof e.length){r&&(e=r);var t=0,a=function(){};return{s:a,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){l=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(l)throw o}}}}(e.bodyParts);try{for(t.s();!(r=t.n()).done;){var a=r.value;if(l[a.id]==n)return a}}catch(e){t.e(e)}finally{t.f()}return null}function E(e){return e.layers[0]}function T(e,n){return null==n?-1:function(e,n){for(var r=32766,t=-1,a=0;a<e.layers.length;a++){var o=e.layers[a],i=Math.abs(o.y-n);i<r&&(r=i,t=a)}return t}(e,n.y)}function u(e,n){var r=n.x-e.x,t=n.y-e.y;return Math.sqrt(r*r+t*t)}function R(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,t=new Array(n);r<n;r++)t[r]=e[r];return t}function L(e){e.parametricNodes=function(e){var n=0,r=[],t=[],a={x:0,y:e.nodes[0].point.x};r.push(a);var o={x:0,y:e.nodes[0].point.y};t.push(o);for(var i=1;i<e.nodes.length;i++){var l=e.nodes[i].point;a={x:n+=u(e.nodes[i-1].point,l),y:l.x},r.push(a),o={x:n,y:l.y},t.push(o)}var _={};return _.xsPoints=r,_.ysPoints=t,_}(e);var n={};n.xs_coeffs=f(e,e.parametricNodes.xsPoints),n.ys_coeffs=f(e,e.parametricNodes.ysPoints),e.parametricCoefficients=n}function f(e,n){var r=e.nodes.length;if(0==r)return null;for(var t=r-1,a=Array(r).fill(0),o=Array(t).fill(0),i=Array(r).fill().map((function(){return Array(r).fill(0)})),l=Array(t+1).fill(0),_=Array(r).fill(0),s=Array(r).fill(0),E=Array(r).fill(0),T=0;T<r;T++){var u=n[T];a[T]=u.x,_[T]=u.y}for(var R=0;R<t;R++)o[R]=a[R+1]-a[R];i[0][0]=1,i[0][1]=0,i[t][t]=1,i[t][t-1]=0;for(var L=1;L<t;L++)i[L][L]=2*(o[L-1]+o[L]),i[L][L-1]=o[L-1],i[L][L+1]=o[L];l[0]=0;for(var f=1;f<t;f++)l[f]=3/o[f]*(_[f+1]-_[f])-3/o[f-1]*(_[f]-_[f-1]);l[t]=0;for(var c=function(e,n,r){var t=Array(e).fill().map((function(){return Array(e).fill(0)})),a=Array(e).fill().map((function(){return Array(e).fill(0)})),o=Array(e).fill(0),i=Array(e).fill(0),l=e-1;if(e>=3){t[0][0]=n[0][0],a[0][1]=n[0][1]/t[0][0];for(var _=1;_<l;_++)t[_][_-1]=n[_][_-1],t[_][_]=n[_][_]-t[_][_-1]*a[_-1][_],a[_][_+1]=n[_][_+1]/t[_][_];t[l][l-1]=n[l][l-1],t[l][l]=n[l][l]-t[l][l-1]*a[l-1][l],o[0]=r[0]/t[0][0];for(var s=1;s<e;s++)o[s]=(r[s]-t[s][s-1]*o[s-1])/t[s][s];i[l]=o[l];for(var E=l-1;E>=0;E--)i[E]=o[E]-a[E][E+1]*i[E+1]}return i}(e.nodes.length,i,l),d=t-1;d>=0;d--)s[d]=(_[d+1]-_[d])/o[d]-o[d]*(c[d+1]+2*c[d])/3,E[d]=(c[d+1]-c[d])/(3*o[d]);for(var y=[],A=0;A<t;A++){var I={a:_[A],b:s[A],c:c[A],d:E[A]};y.push(I)}return y}function c(e,n,r,t){var a=t-r,o=e.b+2*e.c*a+3*e.d*a*a,i=n.b+2*n.c*a+3*n.d*a*a;return Math.sqrt(Math.pow(o,2)+Math.pow(i,2))}function d(e){return e.nodes[e.nodes.length-1]}function y(e,n,r,t,a){var o=[],i=0;if(r>=0&&t>0){var l=e.parametricNodes.xsPoints[r].x;i=(e.parametricNodes.xsPoints[t].x-l)/(n-1);var _=l,s=r,E=e.parametricNodes.xsPoints[s+1].x;if(0!=i)for(var T=0;T<n;T++){for(var u=l+T*i;u>E+1e-4;)s++,_=e.parametricNodes.xsPoints[s].x,E=e.parametricNodes.xsPoints[s+1].x;var R=e.parametricCoefficients.xs_coeffs[s],L=e.parametricCoefficients.ys_coeffs[s],f={point:{x:A(R,_,u),y:A(L,_,u)}};if(a){var c={},d=(u-e.parametricNodes.xsPoints[s].x)/(e.parametricNodes.xsPoints[s+1].x-e.parametricNodes.xsPoints[s].x);c.x=(1-d)*e.nodes[s].colour.x+d*e.nodes[s+1].colour.x,c.y=(1-d)*e.nodes[s].colour.y+d*e.nodes[s+1].colour.y,c.z=(1-d)*e.nodes[s].colour.z+d*e.nodes[s+1].colour.z,f.colour=c}o.push(f)}}return 0==i||r<0||t<0?null:o}function A(e,n,r){var t=r-n;return e.a+e.b*t+e.c*t*t+e.d*t*t*t}function I(e,n,r){if(null==e.nodes)e.nodes=[];else if(0==r);else if(!(Math.abs(n.x-d(e).point.x)+Math.abs(n.y-d(e).point.y)>=r))return!1;var t={point:{x:n.x,y:n.y}};return e.nodes.push(t),!0}function m(e,n){var r,t=[],a=function(e,n){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,n){if(e){if("string"==typeof e)return R(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?R(e,n):void 0}}(e))||n&&e&&"number"==typeof e.length){r&&(e=r);var t=0,a=function(){};return{s:a,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){l=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(l)throw o}}}}(e.nodes);try{for(a.s();!(r=a.n()).done;){var o=r.value;t.push({x:o.point.x,y:n,z:o.point.y})}}catch(e){a.e(e)}finally{a.f()}return t}function O(e,n){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,n){if(e){if("string"==typeof e)return h(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?h(e,n):void 0}}(e))||n&&e&&"number"==typeof e.length){r&&(e=r);var t=0,a=function(){};return{s:a,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){l=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(l)throw o}}}}function h(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,t=new Array(n);r<n;r++)t[r]=e[r];return t}function S(e){var n,r=g(),t=O(e.bodyParts);try{for(t.s();!(n=t.n()).done;){var a=n.value;p(a),N(r,a.extent)}}catch(e){t.e(e)}finally{t.f()}G(r),e.extent=r}function p(e){var n,r=g(),t=O(e.layers);try{for(t.s();!(n=t.n()).done;){var a=n.value;v(a),N(r,a.extent)}}catch(e){t.e(e)}finally{t.f()}if(null!=e.splineRegions){var o,i=O(e.splineRegions);try{for(i.s();!(o=i.n()).done;){var l=o.value;null!=l.vertices?l.extent=F(l.vertices):console.error(l," Vertices list is NULL")}}catch(e){i.e(e)}finally{i.f()}}G(r),e.extent=r}function v(e){var n=g();if(null!=e.pointLayer){var r,t=O(e.pointLayer.points);try{for(t.s();!(r=t.n()).done;)x(n,r.value)}catch(e){t.e(e)}finally{t.f()}}null!=e.splineLayer&&(null!=e.splineLayer.surface&&(H(e.splineLayer.surface),P(n,e.splineLayer.surface.extent,e.y)),null!=e.splineLayer.tape&&(H(e.splineLayer.tape),P(n,e.splineLayer.tape.extent,e.y))),G(n),e.extent=n}function H(e){if(e.nodes.length>2){e.extent={min:{x:32700,y:32700},mid:{x:0,y:0},max:{x:-32700,y:-32700}},e.samplePoints=y(e,200,0,e.nodes.length-1,!1);var n,r=O(e.samplePoints);try{for(r.s();!(n=r.n()).done;){var t=n.value.point;a=e.extent,o=t.x,i=t.y,o>a.max.x&&(a.max.x=o),o<a.min.x&&(a.min.x=o),i>a.max.y&&(a.max.y=i),i<a.min.y&&(a.min.y=i),function(e){e.mid={x:(e.min.x+e.max.x)/2,y:(e.min.y+e.max.y)/2}}(a)}}catch(e){r.e(e)}finally{r.f()}}var a,o,i}function N(e,n){n.max.x>e.max.x&&(e.max.x=n.max.x),n.min.x<e.min.x&&(e.min.x=n.min.x),n.max.y>e.max.y&&(e.max.y=n.max.y),n.min.y<e.min.y&&(e.min.y=n.min.y),n.max.z>e.max.z&&(e.max.z=n.max.z),n.min.z<e.min.z&&(e.min.z=n.min.z)}function x(e,n){n.x>e.max.x&&(e.max.x=n.x),n.x<e.min.x&&(e.min.x=n.x),n.y>e.max.y&&(e.max.y=n.y),n.y<e.min.y&&(e.min.y=n.y),n.z>e.max.z&&(e.max.z=n.z),n.z<e.min.z&&(e.min.z=n.z)}function P(e,n,r){e.min.x=n.min.x,e.min.y=r,e.min.z=n.min.y,e.max.x=n.max.x,e.max.y=r,e.max.z=n.max.y}function g(){return G(e={max:{x:-32700,y:-32700,z:-32700},min:{x:32700,y:32700,z:32700}}),e;var e}function G(e){e.mid=function(e){return{x:(e.min.x+e.max.x)/2,y:(e.min.y+e.max.y)/2,z:(e.min.z+e.max.z)/2}}(e),e.difference=function(e){return{x:e.max.x-e.min.x,y:e.max.y-e.min.y,z:e.max.z-e.min.z}}(e)}function F(e){var n=g();for(var r in e)x(n,r);return G(n),n}function M(e,n){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,n){if(e){if("string"==typeof e)return C(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?C(e,n):void 0}}(e))||n&&e&&"number"==typeof e.length){r&&(e=r);var t=0,a=function(){};return{s:a,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){l=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(l)throw o}}}}function C(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,t=new Array(n);r<n;r++)t[r]=e[r];return t}function W(e,n){var r,t=M(e.layers);try{for(t.s();!(r=t.n()).done;)b(r.value,n)}catch(e){t.e(e)}finally{t.f()}}function b(e,n){null!=e.pointLayer&&function(e,n){var r,t=M(e.points);try{for(t.s();!(r=t.n()).done;){var a=r.value;a.x=a.x-n.x,a.z=a.z-n.z}}catch(e){t.e(e)}finally{t.f()}}(e.pointLayer,n),null!=e.splineLayer&&function(e,n){null!=e.surface&&z(e.surface,n),null!=e.tape&&z(e.tape,n)}(e.splineLayer,n),e.y=e.y+n.y}function z(e,n){var r,t=M(e.nodes);try{for(t.s();!(r=t.n()).done;){var a=r.value.point;a.x=a.x-n.x,a.y=a.y-n.z}}catch(e){t.e(e)}finally{t.f()}e.nodes.length>2&&L(e),H(e)}const w={TOP_HEAD:1,CHIN:2,NAPE:3,NAPE_INTERNAL:4,NAPE_LEVEL:5,NECK_INTERNAL:6,FRONT_NECK:7,LEFT_SIDE_NECK:8,RIGHT_SIDE_NECK:9,LEFT_SHOULDER:10,RIGHT_SHOULDER:11,LEFT_ARMPIT:12,RIGHT_ARMPIT:13,ARMPIT_INTERNAL:14,CHEST_INTERNAL:15,CHEST_LEVEL:16,LOW_CHEST_LEVEL:17,LOW_CHEST_INTERNAL:18,LEFT_NIPPLE:19,RIGHT_NIPPLE:20,REAR_WAIST:21,FRONT_WAIST:22,WAIST_INTERNAL:23,WAIST_LEVEL:24,TOP_HIP_LEVEL:25,SEAT_PROMINENCE:26,HIP_INTERNAL:27,HIP_LEVEL:28,CROTCH:29,FRONT_CHEST:31,FRONT_LOW_CHEST:32,MID_WAIST_INTERNAL:33,MID_WAIST_LEVEL:34,BACK_PROMINENCE:35,ABDOMEN_PROMINENCE:36,BACK_ARCH:37,LOWER_BUTTOCK:38,UPPER_ABDOMEN:39,LOWER_ABDOMEN:40,LEFT_SIDE_WAIST_BILATERAL:41,RIGHT_SIDE_WAIST_BILATERAL:42,SHOULDER_INTERNAL:43,LEFT_ARMPIT_INTERNAL:46,RIGHT_ARMPIT_INTERNAL:47,REAR_MID_WAIST:48,FRONT_MID_WAIST:49,LEFT_TOP_THIGH_INTERNAL:50,RIGHT_TOP_THIGH_INTERNAL:51,LEFT_TOP_THIGH_LEVEL:52,RIGHT_TOP_THIGH_LEVEL:53,LEFT_KNEE_INTERNAL:54,RIGHT_KNEE_INTERNAL:55,LEFT_KNEE_LEVEL:56,RIGHT_KNEE_LEVEL:57,LEFT_CALF:58,RIGHT_CALF:59,LEFT_CALF_LEVEL:60,RIGHT_CALF_LEVEL:61,LEFT_MINIMUM_LEG_INTERNAL:62,RIGHT_MINIMUM_LEG_INTERNAL:63,LEFT_MINIMUM_LEG_LEVEL:64,RIGHT_MINIMUM_LEG_LEVEL:65,LEFT_ANKLE_INTERNAL:66,RIGHT_ANKLE_INTERNAL:67,LEFT_ANKLE_LEVEL:68,RIGHT_ANKLE_LEVEL:69,LEFT_FLOOR:70,RIGHT_FLOOR:71,LEFT_FLOOR_LEVEL:72,RIGHT_FLOOR_LEVEL:73,LEFT_MID_THIGH_LEVEL:75,RIGHT_MID_THIGH_LEVEL:76,LEFT_TOP_ARM_INTERNAL:100,RIGHT_TOP_ARM_INTERNAL:101,LEFT_TOP_ARM_LEVEL:102,RIGHT_TOP_ARM_LEVEL:103,LEFT_ELBOW:104,RIGHT_ELBOW:105,LEFT_ARMCREASE:106,RIGHT_ARMCREASE:107,LEFT_ELBOW_INTERNAL:108,RIGHT_ELBOW_INTERNAL:109,LEFT_WRIST_INNER:110,RIGHT_WRIST_INNER:111,LEFT_WRIST_OUTER:112,RIGHT_WRIST_OUTER:113,LEFT_WRIST_INTERNAL:114,RIGHT_WRIST_INTERNAL:115,LEFT_WRIST_LEVEL:116,RIGHT_WRIST_LEVEL:117,LEFT_HAND:118,RIGHT_HAND:119,CWALL_L_HIGH_CHEST:1501,CWALL_L_ARMPIT:1502,CWALL_L_CHEST:1503,CWALL_L_LOW_CHEST:1504,CWALL_L_WAIST:1505,CWALL_MID_HIGH_CHEST:1506,CWALL_MID_ARMPIT:1507,CWALL_MID_CHEST:1508,CWALL_MID_LOW_CHEST:1509,CWALL_MID_WAIST:1510,CWALL_R_HIGH_CHEST:1511,CWALL_R_ARMPIT:1512,CWALL_R_CHEST:1513,CWALL_R_LOW_CHEST:1514,CWALL_R_WAIST:1515,properties:{1:{name:"Top of head",spline:!0},2:{name:"Chin"},3:{name:"Nape"},4:{name:"Nape internal"},5:{name:"Nape level"},6:{name:"Neck internal",important:!0,spline:!0},7:{name:"Front neck",deform:!0},8:{name:"Left side neck"},9:{name:"Right side neck"},10:{name:"Left shoulder",deform:!0},11:{name:"Right shoulder",deform:!0},12:{name:"Left armpit",important:!0,partition:!0},13:{name:"Right armpit",important:!0,partition:!0},14:{name:"Armpit internal"},15:{name:"Chest internal"},16:{name:"Chest level",deform:!0},17:{name:"Low chest level",important:!0,deform:!0},18:{name:"Low chest internal"},19:{name:"Left nipple"},20:{name:"Right nipple"},21:{name:"Rear waist"},22:{name:"Front waist"},23:{name:"Waist internal",spline:!0},24:{name:"Waist level",important:!0},25:{name:"Top hip level"},26:{name:"Seat prominence",deform:!0},27:{name:"Hip internal",deform:!0},28:{name:"Hip level",important:!0},29:{name:"Crotch",important:!0,partition:!0},31:{name:"Front chest"},32:{name:"Front low chest"},33:{name:"Mid waist internal"},34:{name:"Mid waist level"},35:{name:"Back prominence"},36:{name:"Abdomen prominence"},37:{name:"Back arch"},38:{name:"Lower buttock"},39:{name:"Upper abdomen"},40:{name:"Lower abdomen"},41:{name:"Left side waist bilateral"},42:{name:"Right side waist bilateral"},43:{name:"Shoulder internal"},46:{name:"Left armpit internal"},47:{name:"Right armpit internal"},48:{name:"Rear mid waist"},49:{name:"Front mid waist"},50:{name:"Left top thigh internal",spline:!0},51:{name:"Right top thigh internal",spline:!0},52:{name:"Left top thigh level"},53:{name:"Right top thigh level"},54:{name:"Left knee internal",spline:!0},55:{name:"Right knee internal",spline:!0},56:{name:"Left knee level",important:!0},57:{name:"Right knee level",important:!0},58:{name:"Left calf"},59:{name:"Right calf"},60:{name:"Left calf level"},61:{name:"Right calf level"},62:{name:"Left minimum leg internal"},63:{name:"Right minimum leg internal"},64:{name:"Left minimum leg level"},65:{name:"Right minimum leg level"},66:{name:"Left ankle internal",spline:!0},67:{name:"Right ankle internal",spline:!0},68:{name:"Left ankle level",important:!0},69:{name:"Right ankle level",important:!0},70:{name:"Left floor",spline:!0},71:{name:"Right floor",spline:!0},72:{name:"Left floor level"},73:{name:"Right floor level"},75:{name:"Left mid thigh level"},76:{name:"Right mid thigh level"},100:{name:"Left top arm internal",spline:!0},101:{name:"Right top arm internal",spline:!0},102:{name:"Left top arm level"},103:{name:"Right top arm level"},104:{name:"Left elbow",important:!0},105:{name:"Right elbow",important:!0},106:{name:"Left armcrease"},107:{name:"Right armcrease"},108:{name:"Left elbow internal",spline:!0},109:{name:"Right elbow internal",spline:!0},110:{name:"Left wrist inner",important:!0},111:{name:"Right wrist inner",important:!0},112:{name:"Left wrist outer"},113:{name:"Right wrist outer"},114:{name:"Left wrist internal",deform:!0,spline:!0},115:{name:"Right wrist internal",deform:!0,spline:!0},116:{name:"Left wrist level"},117:{name:"Right wrist level"},118:{name:"Left hand",spline:!0},119:{name:"Right hand",spline:!0},1501:{name:"Chestwall left high chest"},1502:{name:"Chestwall left armpit"},1503:{name:"Chestwall left chest"},1504:{name:"Chestwall left low chest"},1505:{name:"Chestwall left waist"},1506:{name:"Chestwall mid high chest"},1507:{name:"Chestwall mid armpit"},1508:{name:"Chestwall mid chest"},1509:{name:"Chestwall mid low chest"},1510:{name:"Chestwall mid waist"},1511:{name:"Chestwall right high chest"},1512:{name:"Chestwall right armpit"},1513:{name:"Chestwall right chest"},1514:{name:"Chestwall right low chest"},1515:{name:"Chestwall right waist"}},fromInt:function(e){return Object.entries(this).filter((function(e){return"properties"!==e[0]&&"function"!=typeof e[0]})).find((function(n){return n[1]===e}))[0]}};function U(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,t=new Array(n);r<n;r++)t[r]=e[r];return t}function D(e,n){var r,t=function(e,n){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,n){if(e){if("string"==typeof e)return U(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?U(e,n):void 0}}(e))||n&&e&&"number"==typeof e.length){r&&(e=r);var t=0,a=function(){};return{s:a,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){l=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(l)throw o}}}}(e.landmarks);try{for(t.s();!(r=t.n()).done;){var a=r.value;if(w[a.id]==n)return a}}catch(e){t.e(e)}finally{t.f()}return null}const B={TORSO_TOPHEAD:1,TORSO_FRONT_NECK:2,TORSO_NAPE:3,TORSO_NECK:4,TORSO_NECK_PREPROCESS:5,TORSO_NECK_UPPER:6,TORSO_NECK_LOWER:7,TORSO_SHOULDER_PREPROCESS:8,TORSO_SHOULDER:9,TORSO_ARMPIT_LOWER:10,TORSO_ARMPIT_UPPER:11,TORSO_ARMPIT_PREPROCESS:12,TORSO_ARMPIT:13,TORSO_LOW_CHEST_PREPROCESS:14,TORSO_LOW_CHEST:15,TORSO_CHEST_PREPROCESS:16,TORSO_CHEST:17,TORSO_WAIST_PREPROCESS:18,TORSO_WAIST:19,TORSO_WAIST_LOWER:20,TORSO_WAIST_UPPER:21,TORSO_SEAT_PROMINENCE:22,TORSO_HIP_PREPROCESS:23,TORSO_HIP:24,TORSO_HIP_LOWER:25,TORSO_HIP_UPPER:26,TORSO_CROTCH:27,TORSO_CROTCH_ARMPIT_THIRD:28,CHESTWALL_ARMPIT_PREPROCESS:29,CHESTWALL_CHEST_PREPROCESS:30,CHESTWALL_LOW_CHEST_PREPROCESS:31,CHESTWALL_WAIST_PREPROCESS:32,CHESTWALL_HIGH_CHEST_PREPROCESS:33,CHESTWALL_ARMPIT:34,CHESTWALL_CHEST:35,CHESTWALL_LOW_CHEST:36,CHESTWALL_WAIST:37,CHESTWALL_HIGH_CHEST:38,LEFTLEG_FLOOR:39,LEFTLEG_MINIMUM_LEG:40,LEFTLEG_ANKLE:41,LEFTLEG_ANKLE_LOWER:42,LEFTLEG_ANKLE_UPPER:43,LEFTLEG_KNEE:44,LEFTLEG_KNEE_LOWER:45,LEFTLEG_KNEE_UPPER:46,LEFTLEG_THIGH:47,RIGHTLEG_FLOOR:48,RIGHTLEG_MINIMUM_LEG:49,RIGHTLEG_ANKLE:50,RIGHTLEG_ANKLE_LOWER:51,RIGHTLEG_ANKLE_UPPER:52,RIGHTLEG_KNEE:53,RIGHTLEG_KNEE_LOWER:54,RIGHTLEG_KNEE_UPPER:55,RIGHTLEG_THIGH:56,LEFTARM_TOPARM:57,LEFTARM_ELBOW:58,LEFTARM_ELBOW_UPPER:59,LEFTARM_ELBOW_LOWER:60,LEFTARM_WRIST:61,LEFTARM_HAND:62,RIGHTARM_TOPARM:63,RIGHTARM_ELBOW:64,RIGHTARM_ELBOW_UPPER:65,RIGHTARM_ELBOW_LOWER:66,RIGHTARM_WRIST:67,RIGHTARM_HAND:68,fromInt:function(e){return Object.entries(this).filter((function(e){return"properties"!==e[0]&&"function"!=typeof e[0]})).find((function(n){return n[1]===e}))[0]}};function K(e,n){if(e.layerMarkers)return e.layerMarkers.find((function(e){return B[e.layerNameType]==n}))}function X(e,n,r){var t=K(e,n);t?t.value=r:(t={layerNameType:B.fromInt(n),value:r},e.layerMarkers||(e.layerMarkers=[]),e.layerMarkers.push(t))}function j(e,n,r,t){X(e,n,k(e,r,t))}function k(e,n,r){var t=K(e,n),a=K(e,r);return function(e,n,r){for(var t=n;t<r;t++){var a=e.layers[t],o=e.layers[t+1];if(a.y==o.y)return t}return 0}(e,t.value,a.value)}function V(e,n,r){X(e,n,function(e,n){var r=K(e,n);if(r)return r.value}(e,r)+1)}function $(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,t=new Array(n);r<n;r++)t[r]=e[r];return t}function Y(e,n,r){r?layerRefsPreProcessing(e,n):function(e,n){if(l[n.id]==l.LEFT_LEG&&(X(n,B.LEFTLEG_THIGH,n.layers.length-1),X(n,B.LEFTLEG_FLOOR,0),j(n,B.LEFTLEG_ANKLE_LOWER,B.LEFTLEG_FLOOR,B.LEFTLEG_THIGH),V(n,B.LEFTLEG_ANKLE_UPPER,B.LEFTLEG_ANKLE_LOWER),X(n,B.LEFTLEG_KNEE_LOWER,k(n,B.LEFTLEG_ANKLE_UPPER,B.LEFTLEG_THIGH)),V(n,B.LEFTLEG_KNEE_UPPER,B.LEFTLEG_KNEE_LOWER)),l[n.id]==l.RIGHT_LEG&&(X(n,B.RIGHTLEG_THIGH,n.layers.length-1),X(n,B.RIGHTLEG_FLOOR,0),j(n,B.RIGHTLEG_ANKLE_LOWER,B.RIGHTLEG_FLOOR,B.RIGHTLEG_THIGH),V(n,B.RIGHTLEG_ANKLE_UPPER,B.RIGHTLEG_ANKLE_LOWER),j(n,B.RIGHTLEG_KNEE_LOWER,B.RIGHTLEG_ANKLE_UPPER,B.RIGHTLEG_THIGH),V(n,B.RIGHTLEG_KNEE_UPPER,B.RIGHTLEG_KNEE_LOWER)),l[n.id]==l.LEFT_ARM&&(X(n,B.LEFTARM_TOPARM,n.layers.length-1),X(n,B.LEFTARM_HAND,0),j(n,B.LEFTARM_ELBOW_LOWER,B.LEFTARM_HAND,B.LEFTARM_TOPARM),V(n,B.LEFTARM_ELBOW_UPPER,B.LEFTARM_ELBOW_LOWER),X(n,B.LEFTARM_WRIST,0)),l[n.id]==l.RIGHT_ARM&&(X(n,B.RIGHTARM_TOPARM,n.layers.length-1),X(n,B.RIGHTARM_HAND,0),j(n,B.RIGHTARM_ELBOW_LOWER,B.RIGHTARM_HAND,B.RIGHTARM_TOPARM),V(n,B.RIGHTARM_ELBOW_UPPER,B.RIGHTARM_ELBOW_LOWER),X(n,B.RIGHTARM_WRIST,0)),l[n.id]==l.TORSO||l[n.id]==l.CHEST_WALL){var r=D(e,w.CHEST_LEVEL),t=D(e,w.LOW_CHEST_LEVEL),a=D(e,w.LEFT_SHOULDER),o=D(e,w.RIGHT_SHOULDER);X(n,B.TORSO_TOPHEAD,n.layers.length-1),X(n,B.TORSO_CROTCH,0),j(n,B.TORSO_HIP_LOWER,B.TORSO_CROTCH,B.TORSO_TOPHEAD),V(n,B.TORSO_HIP_UPPER,B.TORSO_HIP_LOWER),j(n,B.TORSO_WAIST_LOWER,B.TORSO_HIP_UPPER,B.TORSO_TOPHEAD),V(n,B.TORSO_WAIST_UPPER,B.TORSO_WAIST_LOWER),j(n,B.TORSO_ARMPIT_LOWER,B.TORSO_WAIST_UPPER,B.TORSO_TOPHEAD),V(n,B.TORSO_ARMPIT_UPPER,B.TORSO_ARMPIT_LOWER),j(n,B.TORSO_NECK_LOWER,B.TORSO_ARMPIT_UPPER,B.TORSO_TOPHEAD),V(n,B.TORSO_NECK_UPPER,B.TORSO_NECK_LOWER);var i=K(n,B.TORSO_ARMPIT_LOWER);if(1==e.sex){var _=K(n,B.TORSO_WAIST_UPPER),E=_.value+.8*(i.value-_.value),u=_.value+.8*(E-_.value);X(n,B.TORSO_CHEST,E),X(n,B.TORSO_LOW_CHEST,u)}else X(n,B.TORSO_CHEST,T(n,r)),X(n,B.TORSO_LOW_CHEST,T(n,t));null!=a&&null!=o&&X(n,B.TORSO_SHOULDER,BodyHelper.getNearestLayerID(n,General.mean2numbers(a.y,o.y)));var R=Math.floor(.333*i.value);X(n,B.TORSO_CROTCH_ARMPIT_THIRD,R)}if(l[n.id]==l.CHEST_WALL){var L=s(e,l.TORSO),f=K(L,B.TORSO_LOW_CHEST),c=K(L,B.TORSO_WAIST_UPPER),d=K(L,B.TORSO_ARMPIT_LOWER),y=K(L,B.TORSO_NECK_LOWER),A=K(L,B.TORSO_ARMPIT_UPPER);X(n,B.CHESTWALL_WAIST,0),X(n,B.CHESTWALL_LOW_CHEST,f.value-c.value),X(n,B.CHESTWALL_ARMPIT,d.value-c.value),X(n,B.CHESTWALL_HIGH_CHEST,(y.value+A.value)/2-c.value);var I=K(n,B.CHESTWALL_ARMPIT),m=K(n,B.CHESTWALL_LOW_CHEST);X(n,B.CHESTWALL_CHEST,(5*I.value+5*m.value)/10)}}(e,n);var t=[];if(l[n.id]==l.TORSO){var a=K(n,B.TORSO_NECK_UPPER),o=K(n,B.TORSO_TOPHEAD),i=K(n,B.TORSO_ARMPIT_UPPER),_=K(n,B.TORSO_NECK_LOWER),E=K(n,B.TORSO_WAIST_UPPER),u=K(n,B.TORSO_ARMPIT_LOWER),R=K(n,B.TORSO_HIP_UPPER),L=K(n,B.TORSO_WAIST_LOWER),f=K(n,B.TORSO_CROTCH),c=K(n,B.TORSO_CROTCH_ARMPIT_THIRD);t.push(J(e,n,14,a,o)),t.push(J(e,n,8,i,_)),t.push(J(e,n,3,E,u)),t.push(J(e,n,4,R,L)),t.push(J(e,n,5,f,R)),t.push(J(e,n,36,c,i))}if(l[n.id]==l.CHEST_WALL)if(r){var d=K(n,B.CHESTWALL_WAIST_PREPROCESS),y=K(n,B.CHESTWALL_ARMPIT_PREPROCESS);t.push(J(e,n,3,d,y))}else{var A=K(n,B.CHESTWALL_WAIST),I=K(n,B.CHESTWALL_ARMPIT);t.push(J(e,n,3,A,I))}if(l[n.id]==l.LEFT_LEG){var m=K(n,B.LEFTLEG_KNEE_UPPER),O=K(n,B.LEFTLEG_THIGH),h=K(n,B.LEFTLEG_ANKLE_UPPER),S=K(n,B.LEFTLEG_KNEE_LOWER),p=K(n,B.LEFTLEG_FLOOR),v=K(n,B.LEFTLEG_ANKLE_LOWER);t.push(J(e,n,6,m,O)),t.push(J(e,n,7,h,S)),t.push(J(e,n,13,p,v))}if(l[n.id]==l.RIGHT_LEG){var H=K(n,B.RIGHTLEG_KNEE_UPPER),N=K(n,B.RIGHTLEG_THIGH),x=K(n,B.RIGHTLEG_ANKLE_UPPER),P=K(n,B.RIGHTLEG_KNEE_LOWER),g=K(n,B.RIGHTLEG_FLOOR),G=K(n,B.RIGHTLEG_ANKLE_LOWER);t.push(J(e,n,6,H,N)),t.push(J(e,n,7,x,P)),t.push(J(e,n,13,g,G))}if(l[n.id]==l.LEFT_ARM){var F=K(n,B.LEFTARM_ELBOW_UPPER),M=K(n,B.LEFTARM_TOPARM),C=K(n,B.LEFTARM_WRIST),W=K(n,B.LEFTARM_ELBOW_LOWER);t.push(J(e,n,15,F,M)),t.push(J(e,n,18,C,W))}if(l[n.id]==l.RIGHT_ARM){var b=K(n,B.RIGHTARM_ELBOW_UPPER),z=K(n,B.RIGHTARM_TOPARM),U=K(n,B.RIGHTARM_WRIST),$=K(n,B.RIGHTARM_ELBOW_LOWER);t.push(J(e,n,15,b,z)),t.push(J(e,n,18,U,$))}t=t.filter((function(e){return e})),n.splineRegions=t}function J(e,n,r,t,a){var o=t.value,i=a.value;if(o>=0&&i>=o){var _={id:r,startLayer:o,endLayer:i,startVertex:0},s=null;if(5==r){var E=K(n,B.TORSO_HIP_LOWER);s=n.layers[E.value]}else if(36==r){var T=K(n,B.TORSO_CROTCH_ARMPIT_THIRD);s=n.layers[T.value]}else if(8==r){var u=K(n,B.TORSO_NECK_LOWER);s=n.layers[u.value]}return function(e,n){switch(e.id){case 6:case 7:1==n?(e.noRadial=5,e.noLinear=0,e.noNormalisedLayers=16):2==n?(e.noRadial=7,e.noLinear=0,e.noNormalisedLayers=24):(e.noRadial=9,e.noLinear=0,e.noNormalisedLayers=32);break;case 13:1==n?(e.noRadial=5,e.noLinear=0,e.noNormalisedLayers=4):2==n?(e.noRadial=7,e.noLinear=0,e.noNormalisedLayers=6):(e.noRadial=9,e.noLinear=0,e.noNormalisedLayers=8);break;case 5:1==n?(e.noRadial=4,e.noLinear=8,e.noNormalisedLayers=5):2==n?(e.noRadial=6,e.noLinear=12,e.noNormalisedLayers=8):(e.noRadial=8,e.noLinear=16,e.noNormalisedLayers=10);break;case 4:case 3:1==n?(e.noRadial=8,e.noLinear=0,e.noNormalisedLayers=15):2==n?(e.noRadial=12,e.noLinear=0,e.noNormalisedLayers=24):(e.noRadial=16,e.noLinear=0,e.noNormalisedLayers=30);break;case 8:1==n?(e.noRadial=4,e.noLinear=6,e.noNormalisedLayers=16):2==n?(e.noRadial=6,e.noLinear=20,e.noNormalisedLayers=24):(e.noRadial=8,e.noLinear=12,e.noNormalisedLayers=32);break;case 14:1==n?(e.noRadial=7,e.noLinear=0,e.noNormalisedLayers=10):2==n?(e.noRadial=16,e.noLinear=0,e.noNormalisedLayers=15):(e.noRadial=14,e.noLinear=0,e.noNormalisedLayers=20);break;case 15:1==n?(e.noRadial=4,e.noLinear=0,e.noNormalisedLayers=8):2==n?(e.noRadial=4,e.noLinear=0,e.noNormalisedLayers=12):(e.noRadial=4,e.noLinear=0,e.noNormalisedLayers=16);break;case 18:1==n?(e.noRadial=4,e.noLinear=0,e.noNormalisedLayers=12):2==n?(e.noRadial=4,e.noLinear=0,e.noNormalisedLayers=18):(e.noRadial=4,e.noLinear=0,e.noNormalisedLayers=24);break;default:console.log("Using default Spline Region settings for "+e.id),e.noRadial=5,e.noLinear=5,e.noNormalisedLayers=24}}(_,e.normaliseResolution),function(e,n,r,t,a){var o,i,_,s,E,T,u,R,L,f,c,d,y,A,I,m,O,h,S,p,v,H,N,x={left:{x:0,y:0},right:{x:0,y:0}},P={left:{x:0,y:0},right:{x:0,y:0}};switch(t){case 6:r==l.LEFT_LEG?(i=D(e,w.LEFT_TOP_THIGH_INTERNAL),o=D(e,w.LEFT_KNEE_INTERNAL)):(i=D(e,w.RIGHT_TOP_THIGH_INTERNAL),o=D(e,w.RIGHT_KNEE_INTERNAL)),x.left.x=o.x,x.left.y=o.z,x.right.x=o.x,x.right.y=o.z,P.left.x=i.x,P.left.y=i.z,P.right.x=i.x,P.right.y=i.z;break;case 7:r==l.LEFT_LEG?(s=D(e,w.LEFT_ANKLE_INTERNAL),o=D(e,w.LEFT_KNEE_INTERNAL)):(s=D(e,w.RIGHT_ANKLE_INTERNAL),o=D(e,w.RIGHT_KNEE_INTERNAL)),x.left.x=s.x,x.left.y=s.z,x.right.x=s.x,x.right.y=s.z,P.left.x=o.x,P.left.y=o.z,P.right.x=o.x,P.right.y=o.z;break;case 13:r==l.LEFT_LEG?(s=D(e,w.LEFT_ANKLE_INTERNAL),_=D(e,w.LEFT_FLOOR)):(s=D(e,w.RIGHT_ANKLE_INTERNAL),_=D(e,w.RIGHT_FLOOR)),x.left.x=_.x,x.left.y=_.z,x.right.x=_.x,x.right.y=_.z,P.left.x=s.x,P.left.y=s.z,P.right.x=s.x,P.right.y=s.z;break;case 5:u=D(e,w.HIP_INTERNAL),E=D(e,w.LEFT_TOP_THIGH_INTERNAL),T=D(e,w.RIGHT_TOP_THIGH_INTERNAL);var g=a;x.left.x=E.x,x.left.y=E.z,x.right.x=T.x,x.right.y=T.z,P.left.x=.75*g.extent.min.x+.25*g.extent.max.x,P.left.y=u.z,P.right.x=.25*g.extent.min.x+.75*g.extent.max.x,P.right.y=u.z;break;case 4:u=D(e,w.HIP_INTERNAL),L=D(e,w.WAIST_INTERNAL),x.left.x=u.x,x.left.y=u.z,x.right.x=u.x,x.right.y=u.z,P.left.x=L.x,P.left.y=L.z,P.right.x=L.x,P.right.y=L.z;break;case 3:f=D(e,w.LEFT_ARMPIT),c=D(e,w.RIGHT_ARMPIT),R={x:(f.x+c.x)/2,z:(f.z+c.z)/2},L=D(e,w.WAIST_INTERNAL),x.left.x=L.x,x.left.y=L.z,x.right.x=L.x,x.right.y=L.z,P.left.x=R.x,P.left.y=R.z,P.right.x=R.x,P.right.y=R.z;break;case 36:f=D(e,w.LEFT_ARMPIT),c=D(e,w.RIGHT_ARMPIT),R={x:(f.x+c.x)/2,z:(f.z+c.z)/2};var G=a;x.left.x=G.extent.mid.x,x.left.y=G.extent.mid.z,x.right.x=x.left.x,x.right.y=x.left.y,P.left.x=R.x,P.left.y=R.z,P.right.x=P.left.x,P.right.y=P.left.y;break;case 8:d={x:0,y:0},y={x:0,y:0},f=D(e,w.LEFT_ARMPIT_INTERNAL),c=D(e,w.RIGHT_ARMPIT_INTERNAL),I=D(e,w.NECK_INTERNAL);var F=a;F.extent.max.x-F.extent.min.x<12/(.6-.4)?(N=(F.extent.max.x+F.extent.min.x)/2,d.x=N-6,y.x=N+6):(d.x=.6*F.extent.min.x+.4*F.extent.max.x,y.x=.4*F.extent.min.x+.6*F.extent.max.x),m=D(e,w.LEFT_TOP_ARM_INTERNAL);var M=null!=f?f.x:0,C=null!=f?f.z:0,W=null!=c?c.x:0,b=null!=c?c.z:0;null!=m?(S=General.mean2numbers(m.x,M),v=Math.ceil(.65*m.z+.35*C)):(S=M,v=C),null!=(m=D(e,w.RIGHT_TOP_ARM_INTERNAL))?(p=General.mean2numbers(m.x,W),H=Math.ceil(.65*m.z+.35*b)):(p=W,H=b),x.left.x=S,x.left.y=v,x.right.x=p,x.right.y=H,P.left.x=d.x,P.left.y=I.z,P.right.x=y.x,P.right.y=I.z;break;case 14:A=D(e,w.TOP_HEAD),I=D(e,w.NECK_INTERNAL),x.left.x=I.x,x.left.y=I.z,x.right.x=I.x,x.right.y=I.z,P.left.x=A.x,P.left.y=A.z,P.right.x=A.x,P.right.y=A.z;break;case 15:r==l.LEFT_ARM?(m=D(e,w.LEFT_TOP_ARM_INTERNAL),h=D(e,w.LEFT_ELBOW_INTERNAL)):(m=D(e,w.RIGHT_TOP_ARM_INTERNAL),h=D(e,w.RIGHT_ELBOW_INTERNAL)),x.left.x=h.x,x.left.y=h.z,x.right.x=h.x,x.right.y=h.z,P.left.x=m.x,P.left.y=m.z,P.right.x=m.x,P.right.y=m.z;break;case 18:r==l.LEFT_ARM?(O=D(e,w.LEFT_WRIST_INTERNAL),h=D(e,w.LEFT_ELBOW_INTERNAL)):(O=D(e,w.RIGHT_WRIST_INTERNAL),h=D(e,w.RIGHT_ELBOW_INTERNAL)),x.left.x=O.x,x.left.y=O.z,x.right.x=O.x,x.right.y=O.z,P.left.x=h.x,P.left.y=h.z,P.right.x=h.x,P.right.y=h.z}n.start=x,n.end=P}(e,_,n.id,r,s),_}console.error("create spline region: body part ".concat(n.id," ").concat(r," start layer ").concat(o," and end layer ").concat(i," bad"))}function q(e,n){return e.splineRegions.find((function(e){return e.id==n}))}function Z(e,n,r){return n.startVertex+(r-n.startLayer)*e.layers[r].splineLayer.surface.nodes.length}function Q(e,n,r){if(e)return function(e,n){switch(n){case START_LEFT_X:return e.start.left.x;case START_LEFT_Y:return e.start.left.y;case START_RIGHT_X:return e.start.right.x;case START_RIGHT_Y:return e.start.right.y;case END_LEFT_X:return e.end.left.x;case END_LEFT_Y:return e.end.left.y;case END_RIGHT_X:return e.end.right.x;case END_RIGHT_Y:return e.end.right.y;case START_LAYER:return e.startLayer;case END_LAYER:return e.endLayer;case NRADIAL:return e.noRadial;case NLINEAR:return e.noLinear}return 0}(q(e,n),r)}function ee(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,t=new Array(n);r<n;r++)t[r]=e[r];return t}function ne(e,n,t,a,o,i,l){for(var _,s={},T={id:n,spline:{},outlineRefs:[]},u=e.layers.length-1;u>0&&(1!=o||u!=a);u--){var R=e.layers[u];s.x=2==i?2==l?R.extent.max.x:R.extent.max.z:2==l?R.extent.min.x:R.extent.min.z,s.y=R.y,I(T.spline,s,t)&&re(T,{x:s.x,y:s.y,z:R.extent.mid.z})}_=1==o?e.layers[a]:E(e),s.x=2==i?2==l?_.extent.max.x:_.extent.max.z:2==l?_.extent.min.x:_.extent.min.z,s.y=_.y;var f=I(T.spline,s,t);return f||(remove_end_node(T.spline),I(T.spline,s,t),r("ok")),f&&re(T,{x:s.x,y:s.y,z:_.extent.mid.z}),L(T.spline),T.spline.samplePoints=y(T.spline,200,0,T.spline.nodes.length-1,!1),T}function re(e,n){e.outlineRefs.push(n)}function te(e){var n=Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2)+Math.pow(e.z,2));0!=n&&(e.x=e.x/n,e.y=e.y/n,e.z=e.z/n)}function ae(e,n){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,n){if(e){if("string"==typeof e)return oe(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?oe(e,n):void 0}}(e))||n&&e&&"number"==typeof e.length){r&&(e=r);var t=0,a=function(){};return{s:a,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){l=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(l)throw o}}}}function oe(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,t=new Array(n);r<n;r++)t[r]=e[r];return t}function ie(e){if(!e.DONE_SMOOTH_NORMALS&&e.polygons&&e.polygons.length){e.DONE_NORMALS||function(e){if(!e.DONE_NORMALS){var n,r=e.vertices.length,t=ae(e.polygons);try{for(t.s();!(n=t.n()).done;)_e(e,n.value,r)}catch(e){t.e(e)}finally{t.f()}e.DONE_NORMALS=!0}}(e),console.log("Spline region: "+e.id+", Vertices: "+e.vertices.length+", Polygons: "+e.polygons.length);for(var n,r,t=[],a=0;a<e.vertices.length;a++){var o,i={x:0,y:0,z:0},l=ae(e.polygons);try{for(l.s();!(o=l.n()).done;)for(var _=o.value,s=0;s<e.noSides;s++)a==_.pointReference[s]&&(_.normal?(n=i,r=_.normal,n.x=n.x+r.x,n.y=n.y+r.y,n.z=n.z+r.z):console.log("Polygon has null normal"))}catch(e){l.e(e)}finally{l.f()}t.push(i)}e.normals=t}}function le(e){var n,r=ae(e.normals);try{for(r.s();!(n=r.n()).done;)te(n.value)}catch(e){r.e(e)}finally{r.f()}e.DONE_SMOOTH_NORMALS=!0}function _e(e,n,r){try{for(var t=n.nSides,a=[],o=[],i=0;i<t;i++)o[i]=n.pointReference[i],o[i]>r-1?console.log("Exceeded vertices array size: nVertices: "+r+", index: "+o[i]):a[i]=e.vertices[o[i]];if(a[0]&&a[1]&&a[2]){var l=function(e,n,r){return t={x:n.x-e.x,y:n.y-e.y,z:n.z-e.z},a={x:r.x-e.x,y:r.y-e.y,z:r.z-e.z},te(o={x:t.y*a.z-t.z*a.y,y:t.z*a.x-t.x*a.z,z:t.x*a.y-t.y*a.x}),o;var t,a,o}(a[0],a[1],a[2]);n.normal=l}}catch(n){console.log(e.id+" Normal out of range",n)}}function se(e,n,r,t,a,o){var i=K(e,r),l=K(t,o);return function(e,n,r,t,a,o){var i=e.layers[r],l=t.layers[o];if(i&&l){var _=q(e,n),s=q(t,a),E=i.splineLayer.surface,T=l.splineLayer.surface;return _&&s&&(_.vertices&&s.vertices?function(e,n,r,t,a,o){if(n.nodes.length>0&&a.nodes.length>0){for(var i=[],l=[],_=0;_<n.nodes.length;_++){for(var s=r+_,E=0,T=1e9,R=0;R<a.nodes.length;R++){var L=o+R,f=e.vertices[s],c=t.vertices[L];if(f&&c){var d=u({x:f.x,y:f.z},{x:c.x,y:c.z});d<T&&(E=L,T=d)}else console.log("vertexA or vertexB was missing")}T<300?Ee(e,t,s,E,i,_):(console.log("No vertex within tolerance"),Te(e,s,i,_))}for(var y=0;y<a.nodes.length;y++){for(var A=o+y,I=0,m=1e9,O=0;O<n.nodes.length;O++){var h=r+O,S=e.vertices[h],p=t.vertices[A];if(S&&p){var v=u({x:S.x,y:S.z},{x:p.x,y:p.z});v<m&&(I=h,m=v)}else console.log("vertexA or vertexB was missing")}m<300&&Ee(t,e,A,I,l,y)}for(var H=0;H<n.nodes.length;H++){var N=i[H];N?e.normals[r+H]=N:console.log(e.id+" Normal was NULL: iNodeA: "+H)}for(var x=0;x<a.nodes.length;x++){var P=l[x];P?t.normals[o+x]=P:console.log(t.id+" Normal was NULL: iNodeB: "+x)}}}(_,E,Z(e,_,r),s,T,Z(t,s,o)):console.log(_.id+" or "+s.id+" had empty vertices")),!0}return!1}(e,n,i.value,t,a,l.value)}function Ee(e,n,r,t,a,o){try{var i=e.normals[r],l=n.normals[t];null!=i&&null!=l?a[o]=(s=l,{x:(_=i).x+s.x,y:_.y+s.y,z:_.z+s.z}):console.log(" Vector was null, vIndexB: "+r+", vNearest: "+t)}catch(e){console.error(e)}var _,s}function Te(e,n,r,t){try{var a=e.normals[n];null!=a?r[t]=CopyBean.copy(a):console.log(e.id+" Vector was null, vIndexB: "+n+", list size: "+e.normals.length)}catch(n){console.log(e.id+" Out of bounds")}}function ue(e,n){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,n){if(e){if("string"==typeof e)return Re(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Re(e,n):void 0}}(e))||n&&e&&"number"==typeof e.length){r&&(e=r);var t=0,a=function(){};return{s:a,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){l=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(l)throw o}}}}function Re(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,t=new Array(n);r<n;r++)t[r]=e[r];return t}function Le(e,n){var r,t=ue(n.splineRegions);try{for(t.s();!(r=t.n()).done;){var a=r.value;l[n.id]==l.TORSO?(e.noTorso||5!=a.id&&4!=a.id||fe(n,a,e.colour),e.noBust||3!=a.id&&8!=a.id||fe(n,a,e.colour),e.noHead||14==a.id&&fe(n,a,e.colour)):l[n.id]==l.CHEST_WALL?e.noTorso||e.noBust||3==a.id&&fe(n,a):l[n.id]==l.LEFT_LEG||l[n.id]==l.RIGHT_LEG?e.noLegs||13!=a.id&&7!=a.id&&6!=a.id||fe(n,a,e.colour):l[n.id]==l.RIGHT_ARM||l[n.id]==l.LEFT_ARM?e.noArms||15!=a.id&&18!=a.id||fe(n,a,e.colour):l[n.id]==l.MJB_BUST&&(3!=a.id&&8!=a.id||fe(n,a,e.colour))}}catch(e){t.e(e)}finally{t.f()}}function fe(e,n,r){if(e.layers.length){for(var t=[],a=n.startLayer,o=n.endLayer,i=a;i<=o;i++){var l=e.layers[i];if(l.splineLayer&&l.splineLayer.surface){var _=l.splineLayer.surface;t=t.concat(m(_,l.y))}else console.log(e.id+" "+n.id+" Spline layer empty")}n.vertices=t,n.extent=F(t)}else console.log(e.id+" "+n.id+" Layers are empty")}function ce(e,n,r){var t,a=ue(n.splineRegions);try{for(a.s();!(t=a.n()).done;){var o=t.value;console.log(n.id+", "+o.id),o.noSides=r,l[n.id]==l.TORSO?(e.noTorso||5!=o.id&&4!=o.id&&8!=o.id||de(n,o),e.noBust||3==o.id&&de(n,o),e.noHead||14==o.id&&de(n,o)):l[n.id]==l.CHEST_WALL?e.noTorso||e.noBust||3==o.id&&de(n,o):l[n.id]==l.LEFT_LEG||l[n.id]==l.RIGHT_LEG?e.noLegs||13!=o.id&&7!=o.id&&6!=o.id||de(n,o):l[n.id]==l.LEFT_ARM||l[n.id]==l.RIGHT_ARM?e.noArms||15!=o.id&&18!=o.id||de(n,o):l[n.id]==l.MJB_BUST&&(3!=o.id&&8!=o.id||de(n,o))}}catch(e){a.e(e)}finally{a.f()}}function de(e,n){var r=n.startLayer,t=n.endLayer;if(t>r){for(var a=n.startVertex,o=[],i=r;i<t;i++){var l=e.layers[i],_=e.layers[i+1];if(l)if(null!=_)if(null!=l.splineLayer)if(null!=_.splineLayer){var s=l.splineLayer.surface,E=_.splineLayer.surface;if(s.nodes.length)if(E.nodes.length)if(s.nodes.length==E.nodes.length)if(l.y!=_.y){var T=a+s.nodes.length,u=2*s.nodes.length;if(o.length+u<32766){for(var R=0;R<s.nodes.length-2;R++){var L=ye(n,T+R,T+R+1,a+R);o.push(L);var f=ye(n,a+R,T+R+1,a+R+1);o.push(f)}var c=s.nodes.length-2,d=ye(n,T+c,T,a+c);o.push(d);var y=ye(n,a+c,T,a);o.push(y)}a+=s.nodes.length}else console.log("CubicSpline Same Y Level: A: size: "+s.nodes.length+", y: "+l.y+", B: size: "+E.nodes.length+", y: "+_.y);else console.log(" CubicSpline Node size not equal: A: size: "+s.nodes.length+", y: "+l.y+", B: size: "+E.nodes.length+", y: "+_.y);else console.log(e.id+" "+n.id+" "+_.id+" splineLayer is empty: counter: "+(i+1));else console.log(e.id+" "+n.id+" "+_.id+" splineLayer is empty: counter: "+(i+1))}else console.log(e.id+" "+n.id+" "+_.id+" splineLayer is null: counter: "+(i+1));else console.log(e.id+" "+n.id+" "+l.id+" splineLayer is null: counter: "+i);else console.log(e.id+" "+n.id+" layer is null: counter: "+(i+1));else console.log(e.id+" "+n.id+" layer is null: counter: "+i)}n.polygons=o}}function ye(e,n,r,t){var a=e.vertices.length-1;if(n>a)return console.log("Point Reference 0: Index: "+n+", Exceeded array max: "+a),null;if(r>a)return console.log("Point Reference 1: Index: "+r+", Exceeded array max: "+a),null;if(t>a)return console.log("Point Reference 2: Index: "+t+", Exceeded array max: "+a),null;var o={};o.nSides=e.noSides;var i=[];return i.push(n),i.push(r),i.push(t),o.pointReference=i,o}const Ae={AXF_HEIGHT:1,AXF_NECK_GIRTH:2,AXF_CHEST_GIRTH:3,AXF_BUST_GIRTH:4,AXF_BUST_WIDTH:5,AXF_UNDER_BUST_GIRTH:6,AXF_LOW_CHEST_GIRTH:7,AXF_WAIST_GIRTH:8,AXF_TOP_HIP_GIRTH:9,AXF_SEAT_PROMINENCE_GIRTH:10,AXF_HIP_GIRTH:11,AXF_NAPE_HEIGHT:20,AXF_BUST_HEIGHT:21,AXF_UNDER_BUST_HEIGHT:22,AXF_WAIST_HEIGHT:23,AXF_HIP_HEIGHT:24,AXF_CROTCH_HEIGHT:25,AXF_FRONT_NECK_HEIGHT:26,AXF_TORSO_LENGTH_CROTCH_ARMPIT:27,AXF_NIPPLE_WIDTH:40,AXF_NAPE_TO_WAIST:41,AXF_THROUGH_RISE:42,AXF_NAPE_TO_LEFT_NIPPLE:43,AXF_NAPE_TO_RIGHT_NIPPLE:44,AXF_CENTRE_SHOULDER_TO_REAR_WAIST:45,AXF_BACK_SHOULDER_WIDTH:46,AXF_NAPE_TO_LEFT_SIDE_NECK:47,AXF_NAPE_TO_RIGHT_SIDE_NECK:48,AXF_LEFT_SIDE_NECK_TO_NIPPLE:49,AXF_RIGHT_SIDE_NECK_TO_NIPPLE:50,AXF_CENTRE_SHOULDER_TO_FRONT_WAIST:51,AXF_LEFT_THIGH_GIRTH:70,AXF_RIGHT_THIGH_GIRTH:71,AXF_LEFT_KNEE_GIRTH:72,AXF_RIGHT_KNEE_GIRTH:73,AXF_LEFT_CALF_GIRTH:74,AXF_RIGHT_CALF_GIRTH:75,AXF_LEFT_MINIMUM_LEG_GIRTH:76,AXF_RIGHT_MINIMUM_LEG_GIRTH:77,AXF_LEFT_ANKLE_GIRTH:78,AXF_RIGHT_ANKLE_GIRTH:79,AXF_LEFT_KNEE_HEIGHT:80,AXF_RIGHT_KNEE_HEIGHT:81,AXF_INSIDE_LEG:82,AXF_LEFT_MID_THIGH_GIRTH:83,AXF_RIGHT_MID_THIGH_GIRTH:84,AXF_LEFT_ARM_LENGTH:90,AXF_RIGHT_ARM_LENGTH:91,AXF_LEFT_UNDER_ARM_LENGTH:92,AXF_RIGHT_UNDER_ARM_LENGTH:93,AXF_LEFT_SHOULDER_SLOPE:94,AXF_RIGHT_SHOULDER_SLOPE:95,AXF_LEFT_UPPER_ARM_GIRTH:96,AXF_RIGHT_UPPER_ARM_GIRTH:97,AXF_LEFT_SHOULDER_TO_ELBOW:98,AXF_RIGHT_SHOULDER_TO_ELBOW:99,AXF_LEFT_ELBOW_TO_WRIST:100,AXF_RIGHT_ELBOW_TO_WRIST:101,AXF_LEFT_ARMPIT_TO_ARMCREASE:102,AXF_RIGHT_ARMPIT_TO_ARMCREASE:103,AXF_LEFT_ARMCREASE_TO_WRIST:104,AXF_RIGHT_ARMCREASE_TO_WRIST:105,AXF_LEFT_SHOULDER_LENGTH:106,AXF_RIGHT_SHOULDER_LENGTH:107,AXF_TORSO_LENGTH_CROTCH_ARMPIT_OLD:108,AXF_BUST_PROMINENCE_UPPER:200,AXF_BUST_PROMINENCE_LOWER:201,AXF_BUST_ANGLE:206,AXF_ABDOMEN_PROMINENCE_UPPER:210,AXF_ABDOMEN_PROMINENCE_LOWER:211,AXF_LEFT_FRONT_LATERAL_DEVIATION_UPPER:212,AXF_RIGHT_FRONT_LATERAL_DEVIATION_UPPER:213,AXF_LEFT_FRONT_LATERAL_DEVIATION_LOWER:214,AXF_RIGHT_FRONT_LATERAL_DEVIATION_LOWER:215,AXF_SEAT_PROMINENCE_UPPER:220,AXF_SEAT_PROMINENCE_LOWER:221,AXF_BACK_PROMINENCE_UPPER:230,AXF_BACK_PROMINENCE_LOWER:231,AXF_SIDE_BILATERAL_CROTCH:232,AXF_SIDE_BILATERAL_WAIST:233,AXF_SIDE_BILATERAL_ARMPIT:234,AXF_FRONT_BILATERAL_CROTCH:235,AXF_FRONT_BILATERAL_HIP:236,AXF_FRONT_BILATERAL_WAIST:237,AXF_FRONT_BILATERAL_ARMPIT:238,AXF_FRONT_BILATERAL_MIDHIP:239,AXF_BVI:240,AXF_TORSO_FRONT_CURVINESS:250,AXF_TORSO_REAR_CURVINESS:251,fromInt:function(e){return Object.entries(this).filter((function(e){return"properties"!==e[0]&&"function"!=typeof e[0]})).find((function(n){return n[1]===e}))}};function Ie(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,t=new Array(n);r<n;r++)t[r]=e[r];return t}function me(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new i(e),t={};return Oe(t,r),t.version<1.999&&(t.noHead=!0,t.noArms=!0),t.landmarks=he(r),t.version>1.999&&(t.referenceLocations=pe(r)),ve(t,r),t.bodyParts=Ne(r,t.rawPointsDefined,t.surfaceDefined,t.colour,t.version),r.close(),Ge(t,n),t}function Oe(e,n){e.version=n.readFloat(),e.colour=n.javaBoolean(),e.sex=n.sexType(),e.yResolutionMM=n.readFloat(),e.xZResolutionMM=n.readFloat(),e.rawPointsDefined=n.javaBoolean(),e.surfaceDefined=n.javaBoolean(),e.normalisedPointsInLayer=n.javaBoolean(),e.normalisedLayersInRegion=n.javaBoolean()}function he(e){for(var n=[],r=e.readShort(),t=0;t<r;t++){var a=Se(e);n.push(a)}return n}function Se(e){var n=e.readShort(),r=w.fromInt(n);null==r&&console.log("No landmark type with id: "+n);var t={};return t.id=r,t.x=e.readShort(),t.y=e.readShort(),t.z=e.readShort(),t}function pe(e){for(var n=[],r=e.readShort(),t=0;t<r;t++){var a={};a.id=e.readShort(),a.bodypartID=e.readShort(),a.layerId=e.readShort(),a.pointId=e.readInt(),a.visible=!1,n.push(a)}return n}function ve(e,n){var r=n.readShort();e.personDetails=[],e.measurements=[];for(var t=0;t<r;t++)e.personDetails.push(n.readShort());var a,o=function(e,n){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,n){if(e){if("string"==typeof e)return Ie(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ie(e,n):void 0}}(e))||n&&e&&"number"==typeof e.length){r&&(e=r);var t=0,a=function(){};return{s:a,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){l=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(l)throw o}}}}(e.personDetails);try{for(o.s();!(a=o.n()).done;)switch(a.value){case 2:case 3:break;case 1:for(var i=n.readShort(),l=0;l<i;l++)e.measurements.push(He(n));break;case 4:e.chestWallDefinition=ge(n,e.version)}}catch(e){o.e(e)}finally{o.f()}}function He(e){var n=e.readShort(),r=Ae.fromInt(n);null==r&&log.severe("No measurement type with id: "+n);var t={};return t.id=r,t.value=e.readFloat(),t}function Ne(e,n,r,t,a){for(var o=[],i=e.readShort(),l=0;l<i;l++){var _=xe(e,n,r,t,a);null!=_&&o.push(_)}return o}function xe(e,n,t,a,o){var i=e.readShort(),_=l.fromInt(i);if(null==_)return console.error("Bodypart not recognised"),null;console.log("Reading bodypart id: "+l[_]+", name: "+_);var s=e.readShort(),E=e.readShort();console.log("Number of layers: "+E);for(var T=[],u=0;u<E;u++){var R=Pe(e,n,t,a,o);null==R?r("failedLayer"):T.push(R)}return{id:_,layerOffset:s,layers:T}}function Pe(e,n,r,t,a){var o={y:e.readShort()};if(1==n&&(o.pointLayer=function(e,n,r){for(var t={},a=[],o=[],i=e.readShort(),l=0;l<i;l++){var _={},s={};_.x=e.readShort(),_.y=n,_.z=e.readShort(),1==r?(s.x=e.readByte(),s.y=e.readByte(),s.z=e.readByte()):(s.x=255,s.y=255,s.z=255),a.push(_),o.push(s)}return t.points=a,t.colours=o,t}(e,o.y,t)),1==r){var i=function(e,n,r){var t=function(e,n,r){for(var t=[],a=e.readShort(),o=0;o<a;o++){var i={};1==n?i.point={x:e.readDouble(),y:e.readDouble()}:n>1.0001&&n<3.99999?i.point={x:e.readShort(),y:e.readShort()}:n>=3.99999&&(i.point={x:e.readFloat(),y:e.readFloat()}),i.colour=1==r?{x:e.readByte(),y:e.readByte(),z:e.readByte()}:{x:255,y:255,z:255},t.push(i)}if(!t.length)return null;var l={nodes:t};return L(l),l.surfaceMeasure=function(e,n,r){for(var t=0,a=0,o=n;o<r;o++){for(var i=e.parametricCoefficients.xs_coeffs[o],l=e.parametricCoefficients.ys_coeffs[o],_=e.parametricNodes.xsPoints[o].x,s=e.parametricNodes.xsPoints[o].x,E=(s-_)/22,T=c(i,l,_,_),u=c(i,l,_,s),R=0,L=1;L<10;L++)R=R+4*c(i,l,_,t=_+(2*L-1)*E)+2*c(i,l,_,t=_+2*L*E);a+=E*(T+R+4*c(i,l,_,t+=E)+u)/3}return a}(l,0,l.nodes.length-1),l}(e,n,r);return null==t?null:{surface:t}}(e,a,t);if(null==i)return console.error("Empty spline, layer ignored: y: "+o.y),null;o.splineLayer=i}return o}function ge(e,n){var r={};return r.useMidBust=e.javaBoolean(),n>3.01&&(r.regenerateArmpitPoints=e.javaBoolean()),r.threeLines=e.javaBoolean(),r.armpit_z_biasL=e.readDouble(),r.armpit_z_biasR=e.readDouble(),n>3&&(r.chest_z_biasL=e.readDouble(),r.chest_z_biasR=e.readDouble()),r.waist_z_biasL=e.readDouble(),r.waist_z_biasR=e.readDouble(),r.left_bust_x_bias=e.readDouble(),r.right_bust_x_bias=e.readDouble(),r.mid_bust_x_bias=e.readDouble(),r.z_midspline_adjust_highchest=e.readShort(),r.z_midspline_adjust_armpit=e.readShort(),r.z_midspline_adjust_bust=e.readShort(),r.z_midspline_adjust_underbust=e.readShort(),r.z_midspline_adjust_waist=e.readShort(),r.z_leftspline_adjust_highchest=e.readShort(),r.z_leftspline_adjust_armpit=e.readShort(),r.z_leftspline_adjust_bust=e.readShort(),r.z_leftspline_adjust_underbust=e.readShort(),r.z_leftspline_adjust_waist=e.readShort(),r.z_rightspline_adjust_highchest=e.readShort(),r.z_rightspline_adjust_armpit=e.readShort(),r.z_rightspline_adjust_bust=e.readShort(),r.z_rightspline_adjust_underbust=e.readShort(),r.z_rightspline_adjust_waist=e.readShort(),r.y_midspline_adjust_highchest=e.readShort(),r.y_midspline_adjust_armpit=e.readShort(),r.y_midspline_adjust_bust=e.readShort(),r.y_midspline_adjust_underbust=e.readShort(),r.y_midspline_adjust_waist=e.readShort(),r.y_leftspline_adjust_highchest=e.readShort(),r.y_leftspline_adjust_armpit=e.readShort(),r.y_leftspline_adjust_bust=e.readShort(),r.y_leftspline_adjust_underbust=e.readShort(),r.y_leftspline_adjust_waist=e.readShort(),r.y_rightspline_adjust_highchest=e.readShort(),r.y_rightspline_adjust_armpit=e.readShort(),r.y_rightspline_adjust_bust=e.readShort(),r.y_rightspline_adjust_underbust=e.readShort(),r.y_rightspline_adjust_waist=e.readShort(),r}function Ge(e,n){!function(e){S(e);var n,r={x:(e.extent.min.x+e.extent.max.x)/2,y:(e.extent.min.y+e.extent.max.y)/2,z:(e.extent.min.z+e.extent.max.z)/2},t=M(e.bodyParts);try{for(t.s();!(n=t.n()).done;)W(n.value,r)}catch(e){t.e(e)}finally{t.f()}var a,o=M(e.landmarks);try{for(o.s();!(a=o.n()).done;){var i=a.value;i.x=i.x-r.x,i.y=i.y-r.y,i.z=i.z-r.z}}catch(e){o.e(e)}finally{o.f()}S(e)}(e),function(e){var n,r,t=function(e,n){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,n){if(e){if("string"==typeof e)return ee(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ee(e,n):void 0}}(e))||n&&e&&"number"==typeof e.length){r&&(e=r);var t=0,a=function(){};return{s:a,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){l=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(l)throw o}}}}(e.bodyParts);try{for(t.s();!(n=t.n()).done;)(r=n.value).frontSilhouette=function(e){var n=[];switch(e.id){case"LEFT_LEG":case"RIGHT_LEG":n.push(ne(e,1,0,0,2,1,2)),n.push(ne(e,2,0,0,2,2,2));break;case"LEFT_ARM":case"RIGHT_ARM":n.push(ne(e,9,0,0,2,1,2)),n.push(ne(e,10,0,0,2,2,2));break;case"TORSO":n.push(ne(e,17,0,0,2,1,2)),n.push(ne(e,20,0,0,2,2,2));break;default:return null}return n}(r),r.sideSilhouette=function(e){var n=[];return l[e.id]==l.LEFT_LEG||l[e.id]==l.RIGHT_LEG?(n.push(ne(e,6,0,0,2,2,1)),n.push(ne(e,5,0,0,2,1,1))):l[e.id]==l.TORSO&&(n.push(ne(e,24,0,0,2,2,1)),n.push(ne(e,24,0,0,1,2,1)),n.push(ne(e,25,0,0,2,1,1)),n.push(ne(e,25,0,0,1,1,1))),n}(r)}catch(e){t.e(e)}finally{t.f()}}(e),e.surfaceDefined&&(e.normaliseResolution=function(e){var n=s(e,l.TORSO);if(null==n)return null;switch(E(n).splineLayer.surface.nodes.length){case 33:return 1;case 49:return 2;case 65:return 3}}(e),function(e,n,r){var t,a=function(e,n){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,n){if(e){if("string"==typeof e)return $(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?$(e,n):void 0}}(e))||n&&e&&"number"==typeof e.length){r&&(e=r);var t=0,a=function(){};return{s:a,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){l=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(l)throw o}}}}(e.bodyParts);try{for(a.s();!(t=a.n()).done;)Y(e,t.value,false)}catch(e){a.e(e)}finally{a.f()}}(e),function(e,n,r){var t,a=ue(e.bodyParts);try{for(a.s();!(t=a.n()).done;){var o=t.value;Le(e,o),ce(e,o,3)}}catch(e){a.e(e)}finally{a.f()}r&&function(e){!function(e){var n,r=ae(e.bodyParts);try{for(r.s();!(n=r.n()).done;){var t,a=n.value,o=ae(a.splineRegions);try{for(o.s();!(t=o.n()).done;){var i=t.value;i.vertices&&i.vertices.length?(ie(i),i.DONE_SMOOTH_NORMALS=!0):console.error(a.id+" "+i.id+" Vertices list is NULL")}}catch(e){o.e(e)}finally{o.f()}}}catch(e){r.e(e)}finally{r.f()}}(e),function(e){if(!(e.version<1.999)){var n=s(e,l.TORSO),r=s(e,l.LEFT_LEG),t=s(e,l.RIGHT_LEG),a=s(e,l.LEFT_ARM),o=s(e,l.RIGHT_ARM),i=s(e,l.MJB_BUST);if(n&&(e.noHead||e.noTorso||se(n,8,B.TORSO_NECK_LOWER,n,14,B.TORSO_NECK_UPPER),e.noTorso||(se(n,3,B.TORSO_ARMPIT_LOWER,n,8,B.TORSO_ARMPIT_UPPER),se(n,4,B.TORSO_WAIST_LOWER,n,3,B.TORSO_WAIST_UPPER),se(n,5,B.TORSO_HIP_LOWER,n,4,B.TORSO_HIP_UPPER)),e.noTorso||e.noLegs||(r&&se(n,5,B.TORSO_CROTCH,r,6,B.LEFTLEG_THIGH),t&&se(n,5,B.TORSO_CROTCH,t,6,B.RIGHTLEG_THIGH))),e.noLegs||(r&&(se(r,6,B.LEFTLEG_KNEE_UPPER,r,7,B.LEFTLEG_KNEE_LOWER),se(r,7,B.LEFTLEG_ANKLE_UPPER,r,13,B.LEFTLEG_ANKLE_LOWER)),t&&(se(t,6,B.RIGHTLEG_KNEE_UPPER,t,7,B.RIGHTLEG_KNEE_LOWER),se(t,7,B.RIGHTLEG_ANKLE_UPPER,t,13,B.RIGHTLEG_ANKLE_LOWER))),e.noArms||(a&&se(a,15,B.LEFTARM_ELBOW_UPPER,a,18,B.LEFTARM_ELBOW_LOWER),o&&se(o,15,B.RIGHTARM_ELBOW_UPPER,o,18,B.RIGHTARM_ELBOW_LOWER)),i){var _=Q(i,3,10);se(i,8,Q(i,8,9),i,3,_)}}}(e),function(e){var n,r=ae(e.bodyParts);try{for(r.s();!(n=r.n()).done;){var t,a=ae(n.value.splineRegions);try{for(a.s();!(t=a.n()).done;){var o=t.value;o.vertices&&o.vertices.length?le(o):console.error(o.id+" Vertices list is NULL")}}catch(e){a.e(e)}finally{a.f()}}}catch(e){r.e(e)}finally{r.f()}}(e)}(e),e.surfaceDefined=!0}(e,0,n))}function Fe(e){for(var n=new i(e),r=(n.readNumericType("Int32"),n.readNumericType("Int32"),n.readNumericType("Int32"),n.readNumericType("Int8"),n.readNumericType("Int32")),t=[],a=0;a<r;a++){var o=n.readNumericType("Int32");t.push({sensorSize:o,points:[]})}for(var l=0,_=t;l<_.length;l++)for(var s=_[l],E=0;E<s.sensorSize;E++)s.points.push({x:n.readFloat(),y:n.readFloat(),z:n.readFloat()});return console.log("Finished reading coords"),t}var Me=n.w,Ce=n.K;export{Me as ReadBinaryFile,Ce as readAxf};